{"version":3,"file":"compress.min.js","sources":["../node_modules/exif-js/exif.js","../src/compress.js"],"sourcesContent":["(function() {\n\n    var debug = false;\n\n    var root = this;\n\n    var EXIF = function(obj) {\n        if (obj instanceof EXIF) return obj;\n        if (!(this instanceof EXIF)) return new EXIF(obj);\n        this.EXIFwrapped = obj;\n    };\n\n    if (typeof exports !== 'undefined') {\n        if (typeof module !== 'undefined' && module.exports) {\n            exports = module.exports = EXIF;\n        }\n        exports.EXIF = EXIF;\n    } else {\n        root.EXIF = EXIF;\n    }\n\n    var ExifTags = EXIF.Tags = {\n\n        // version tags\n        0x9000 : \"ExifVersion\",             // EXIF version\n        0xA000 : \"FlashpixVersion\",         // Flashpix format version\n\n        // colorspace tags\n        0xA001 : \"ColorSpace\",              // Color space information tag\n\n        // image configuration\n        0xA002 : \"PixelXDimension\",         // Valid width of meaningful image\n        0xA003 : \"PixelYDimension\",         // Valid height of meaningful image\n        0x9101 : \"ComponentsConfiguration\", // Information about channels\n        0x9102 : \"CompressedBitsPerPixel\",  // Compressed bits per pixel\n\n        // user information\n        0x927C : \"MakerNote\",               // Any desired information written by the manufacturer\n        0x9286 : \"UserComment\",             // Comments by user\n\n        // related file\n        0xA004 : \"RelatedSoundFile\",        // Name of related sound file\n\n        // date and time\n        0x9003 : \"DateTimeOriginal\",        // Date and time when the original image was generated\n        0x9004 : \"DateTimeDigitized\",       // Date and time when the image was stored digitally\n        0x9290 : \"SubsecTime\",              // Fractions of seconds for DateTime\n        0x9291 : \"SubsecTimeOriginal\",      // Fractions of seconds for DateTimeOriginal\n        0x9292 : \"SubsecTimeDigitized\",     // Fractions of seconds for DateTimeDigitized\n\n        // picture-taking conditions\n        0x829A : \"ExposureTime\",            // Exposure time (in seconds)\n        0x829D : \"FNumber\",                 // F number\n        0x8822 : \"ExposureProgram\",         // Exposure program\n        0x8824 : \"SpectralSensitivity\",     // Spectral sensitivity\n        0x8827 : \"ISOSpeedRatings\",         // ISO speed rating\n        0x8828 : \"OECF\",                    // Optoelectric conversion factor\n        0x9201 : \"ShutterSpeedValue\",       // Shutter speed\n        0x9202 : \"ApertureValue\",           // Lens aperture\n        0x9203 : \"BrightnessValue\",         // Value of brightness\n        0x9204 : \"ExposureBias\",            // Exposure bias\n        0x9205 : \"MaxApertureValue\",        // Smallest F number of lens\n        0x9206 : \"SubjectDistance\",         // Distance to subject in meters\n        0x9207 : \"MeteringMode\",            // Metering mode\n        0x9208 : \"LightSource\",             // Kind of light source\n        0x9209 : \"Flash\",                   // Flash status\n        0x9214 : \"SubjectArea\",             // Location and area of main subject\n        0x920A : \"FocalLength\",             // Focal length of the lens in mm\n        0xA20B : \"FlashEnergy\",             // Strobe energy in BCPS\n        0xA20C : \"SpatialFrequencyResponse\",    //\n        0xA20E : \"FocalPlaneXResolution\",   // Number of pixels in width direction per FocalPlaneResolutionUnit\n        0xA20F : \"FocalPlaneYResolution\",   // Number of pixels in height direction per FocalPlaneResolutionUnit\n        0xA210 : \"FocalPlaneResolutionUnit\",    // Unit for measuring FocalPlaneXResolution and FocalPlaneYResolution\n        0xA214 : \"SubjectLocation\",         // Location of subject in image\n        0xA215 : \"ExposureIndex\",           // Exposure index selected on camera\n        0xA217 : \"SensingMethod\",           // Image sensor type\n        0xA300 : \"FileSource\",              // Image source (3 == DSC)\n        0xA301 : \"SceneType\",               // Scene type (1 == directly photographed)\n        0xA302 : \"CFAPattern\",              // Color filter array geometric pattern\n        0xA401 : \"CustomRendered\",          // Special processing\n        0xA402 : \"ExposureMode\",            // Exposure mode\n        0xA403 : \"WhiteBalance\",            // 1 = auto white balance, 2 = manual\n        0xA404 : \"DigitalZoomRation\",       // Digital zoom ratio\n        0xA405 : \"FocalLengthIn35mmFilm\",   // Equivalent foacl length assuming 35mm film camera (in mm)\n        0xA406 : \"SceneCaptureType\",        // Type of scene\n        0xA407 : \"GainControl\",             // Degree of overall image gain adjustment\n        0xA408 : \"Contrast\",                // Direction of contrast processing applied by camera\n        0xA409 : \"Saturation\",              // Direction of saturation processing applied by camera\n        0xA40A : \"Sharpness\",               // Direction of sharpness processing applied by camera\n        0xA40B : \"DeviceSettingDescription\",    //\n        0xA40C : \"SubjectDistanceRange\",    // Distance to subject\n\n        // other tags\n        0xA005 : \"InteroperabilityIFDPointer\",\n        0xA420 : \"ImageUniqueID\"            // Identifier assigned uniquely to each image\n    };\n\n    var TiffTags = EXIF.TiffTags = {\n        0x0100 : \"ImageWidth\",\n        0x0101 : \"ImageHeight\",\n        0x8769 : \"ExifIFDPointer\",\n        0x8825 : \"GPSInfoIFDPointer\",\n        0xA005 : \"InteroperabilityIFDPointer\",\n        0x0102 : \"BitsPerSample\",\n        0x0103 : \"Compression\",\n        0x0106 : \"PhotometricInterpretation\",\n        0x0112 : \"Orientation\",\n        0x0115 : \"SamplesPerPixel\",\n        0x011C : \"PlanarConfiguration\",\n        0x0212 : \"YCbCrSubSampling\",\n        0x0213 : \"YCbCrPositioning\",\n        0x011A : \"XResolution\",\n        0x011B : \"YResolution\",\n        0x0128 : \"ResolutionUnit\",\n        0x0111 : \"StripOffsets\",\n        0x0116 : \"RowsPerStrip\",\n        0x0117 : \"StripByteCounts\",\n        0x0201 : \"JPEGInterchangeFormat\",\n        0x0202 : \"JPEGInterchangeFormatLength\",\n        0x012D : \"TransferFunction\",\n        0x013E : \"WhitePoint\",\n        0x013F : \"PrimaryChromaticities\",\n        0x0211 : \"YCbCrCoefficients\",\n        0x0214 : \"ReferenceBlackWhite\",\n        0x0132 : \"DateTime\",\n        0x010E : \"ImageDescription\",\n        0x010F : \"Make\",\n        0x0110 : \"Model\",\n        0x0131 : \"Software\",\n        0x013B : \"Artist\",\n        0x8298 : \"Copyright\"\n    };\n\n    var GPSTags = EXIF.GPSTags = {\n        0x0000 : \"GPSVersionID\",\n        0x0001 : \"GPSLatitudeRef\",\n        0x0002 : \"GPSLatitude\",\n        0x0003 : \"GPSLongitudeRef\",\n        0x0004 : \"GPSLongitude\",\n        0x0005 : \"GPSAltitudeRef\",\n        0x0006 : \"GPSAltitude\",\n        0x0007 : \"GPSTimeStamp\",\n        0x0008 : \"GPSSatellites\",\n        0x0009 : \"GPSStatus\",\n        0x000A : \"GPSMeasureMode\",\n        0x000B : \"GPSDOP\",\n        0x000C : \"GPSSpeedRef\",\n        0x000D : \"GPSSpeed\",\n        0x000E : \"GPSTrackRef\",\n        0x000F : \"GPSTrack\",\n        0x0010 : \"GPSImgDirectionRef\",\n        0x0011 : \"GPSImgDirection\",\n        0x0012 : \"GPSMapDatum\",\n        0x0013 : \"GPSDestLatitudeRef\",\n        0x0014 : \"GPSDestLatitude\",\n        0x0015 : \"GPSDestLongitudeRef\",\n        0x0016 : \"GPSDestLongitude\",\n        0x0017 : \"GPSDestBearingRef\",\n        0x0018 : \"GPSDestBearing\",\n        0x0019 : \"GPSDestDistanceRef\",\n        0x001A : \"GPSDestDistance\",\n        0x001B : \"GPSProcessingMethod\",\n        0x001C : \"GPSAreaInformation\",\n        0x001D : \"GPSDateStamp\",\n        0x001E : \"GPSDifferential\"\n    };\n\n     // EXIF 2.3 Spec\n    var IFD1Tags = EXIF.IFD1Tags = {\n        0x0100: \"ImageWidth\",\n        0x0101: \"ImageHeight\",\n        0x0102: \"BitsPerSample\",\n        0x0103: \"Compression\",\n        0x0106: \"PhotometricInterpretation\",\n        0x0111: \"StripOffsets\",\n        0x0112: \"Orientation\",\n        0x0115: \"SamplesPerPixel\",\n        0x0116: \"RowsPerStrip\",\n        0x0117: \"StripByteCounts\",\n        0x011A: \"XResolution\",\n        0x011B: \"YResolution\",\n        0x011C: \"PlanarConfiguration\",\n        0x0128: \"ResolutionUnit\",\n        0x0201: \"JpegIFOffset\",    // When image format is JPEG, this value show offset to JPEG data stored.(aka \"ThumbnailOffset\" or \"JPEGInterchangeFormat\")\n        0x0202: \"JpegIFByteCount\", // When image format is JPEG, this value shows data size of JPEG image (aka \"ThumbnailLength\" or \"JPEGInterchangeFormatLength\")\n        0x0211: \"YCbCrCoefficients\",\n        0x0212: \"YCbCrSubSampling\",\n        0x0213: \"YCbCrPositioning\",\n        0x0214: \"ReferenceBlackWhite\"\n    };\n\n    var StringValues = EXIF.StringValues = {\n        ExposureProgram : {\n            0 : \"Not defined\",\n            1 : \"Manual\",\n            2 : \"Normal program\",\n            3 : \"Aperture priority\",\n            4 : \"Shutter priority\",\n            5 : \"Creative program\",\n            6 : \"Action program\",\n            7 : \"Portrait mode\",\n            8 : \"Landscape mode\"\n        },\n        MeteringMode : {\n            0 : \"Unknown\",\n            1 : \"Average\",\n            2 : \"CenterWeightedAverage\",\n            3 : \"Spot\",\n            4 : \"MultiSpot\",\n            5 : \"Pattern\",\n            6 : \"Partial\",\n            255 : \"Other\"\n        },\n        LightSource : {\n            0 : \"Unknown\",\n            1 : \"Daylight\",\n            2 : \"Fluorescent\",\n            3 : \"Tungsten (incandescent light)\",\n            4 : \"Flash\",\n            9 : \"Fine weather\",\n            10 : \"Cloudy weather\",\n            11 : \"Shade\",\n            12 : \"Daylight fluorescent (D 5700 - 7100K)\",\n            13 : \"Day white fluorescent (N 4600 - 5400K)\",\n            14 : \"Cool white fluorescent (W 3900 - 4500K)\",\n            15 : \"White fluorescent (WW 3200 - 3700K)\",\n            17 : \"Standard light A\",\n            18 : \"Standard light B\",\n            19 : \"Standard light C\",\n            20 : \"D55\",\n            21 : \"D65\",\n            22 : \"D75\",\n            23 : \"D50\",\n            24 : \"ISO studio tungsten\",\n            255 : \"Other\"\n        },\n        Flash : {\n            0x0000 : \"Flash did not fire\",\n            0x0001 : \"Flash fired\",\n            0x0005 : \"Strobe return light not detected\",\n            0x0007 : \"Strobe return light detected\",\n            0x0009 : \"Flash fired, compulsory flash mode\",\n            0x000D : \"Flash fired, compulsory flash mode, return light not detected\",\n            0x000F : \"Flash fired, compulsory flash mode, return light detected\",\n            0x0010 : \"Flash did not fire, compulsory flash mode\",\n            0x0018 : \"Flash did not fire, auto mode\",\n            0x0019 : \"Flash fired, auto mode\",\n            0x001D : \"Flash fired, auto mode, return light not detected\",\n            0x001F : \"Flash fired, auto mode, return light detected\",\n            0x0020 : \"No flash function\",\n            0x0041 : \"Flash fired, red-eye reduction mode\",\n            0x0045 : \"Flash fired, red-eye reduction mode, return light not detected\",\n            0x0047 : \"Flash fired, red-eye reduction mode, return light detected\",\n            0x0049 : \"Flash fired, compulsory flash mode, red-eye reduction mode\",\n            0x004D : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected\",\n            0x004F : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected\",\n            0x0059 : \"Flash fired, auto mode, red-eye reduction mode\",\n            0x005D : \"Flash fired, auto mode, return light not detected, red-eye reduction mode\",\n            0x005F : \"Flash fired, auto mode, return light detected, red-eye reduction mode\"\n        },\n        SensingMethod : {\n            1 : \"Not defined\",\n            2 : \"One-chip color area sensor\",\n            3 : \"Two-chip color area sensor\",\n            4 : \"Three-chip color area sensor\",\n            5 : \"Color sequential area sensor\",\n            7 : \"Trilinear sensor\",\n            8 : \"Color sequential linear sensor\"\n        },\n        SceneCaptureType : {\n            0 : \"Standard\",\n            1 : \"Landscape\",\n            2 : \"Portrait\",\n            3 : \"Night scene\"\n        },\n        SceneType : {\n            1 : \"Directly photographed\"\n        },\n        CustomRendered : {\n            0 : \"Normal process\",\n            1 : \"Custom process\"\n        },\n        WhiteBalance : {\n            0 : \"Auto white balance\",\n            1 : \"Manual white balance\"\n        },\n        GainControl : {\n            0 : \"None\",\n            1 : \"Low gain up\",\n            2 : \"High gain up\",\n            3 : \"Low gain down\",\n            4 : \"High gain down\"\n        },\n        Contrast : {\n            0 : \"Normal\",\n            1 : \"Soft\",\n            2 : \"Hard\"\n        },\n        Saturation : {\n            0 : \"Normal\",\n            1 : \"Low saturation\",\n            2 : \"High saturation\"\n        },\n        Sharpness : {\n            0 : \"Normal\",\n            1 : \"Soft\",\n            2 : \"Hard\"\n        },\n        SubjectDistanceRange : {\n            0 : \"Unknown\",\n            1 : \"Macro\",\n            2 : \"Close view\",\n            3 : \"Distant view\"\n        },\n        FileSource : {\n            3 : \"DSC\"\n        },\n\n        Components : {\n            0 : \"\",\n            1 : \"Y\",\n            2 : \"Cb\",\n            3 : \"Cr\",\n            4 : \"R\",\n            5 : \"G\",\n            6 : \"B\"\n        }\n    };\n\n    function addEvent(element, event, handler) {\n        if (element.addEventListener) {\n            element.addEventListener(event, handler, false);\n        } else if (element.attachEvent) {\n            element.attachEvent(\"on\" + event, handler);\n        }\n    }\n\n    function imageHasData(img) {\n        return !!(img.exifdata);\n    }\n\n\n    function base64ToArrayBuffer(base64, contentType) {\n        contentType = contentType || base64.match(/^data\\:([^\\;]+)\\;base64,/mi)[1] || ''; // e.g. 'data:image/jpeg;base64,...' => 'image/jpeg'\n        base64 = base64.replace(/^data\\:([^\\;]+)\\;base64,/gmi, '');\n        var binary = atob(base64);\n        var len = binary.length;\n        var buffer = new ArrayBuffer(len);\n        var view = new Uint8Array(buffer);\n        for (var i = 0; i < len; i++) {\n            view[i] = binary.charCodeAt(i);\n        }\n        return buffer;\n    }\n\n    function objectURLToBlob(url, callback) {\n        var http = new XMLHttpRequest();\n        http.open(\"GET\", url, true);\n        http.responseType = \"blob\";\n        http.onload = function(e) {\n            if (this.status == 200 || this.status === 0) {\n                callback(this.response);\n            }\n        };\n        http.send();\n    }\n\n    function getImageData(img, callback) {\n        function handleBinaryFile(binFile) {\n            var data = findEXIFinJPEG(binFile);\n            img.exifdata = data || {};\n            var iptcdata = findIPTCinJPEG(binFile);\n            img.iptcdata = iptcdata || {};\n            if (EXIF.isXmpEnabled) {\n               var xmpdata= findXMPinJPEG(binFile);\n               img.xmpdata = xmpdata || {};               \n            }\n            if (callback) {\n                callback.call(img);\n            }\n        }\n\n        if (img.src) {\n            if (/^data\\:/i.test(img.src)) { // Data URI\n                var arrayBuffer = base64ToArrayBuffer(img.src);\n                handleBinaryFile(arrayBuffer);\n\n            } else if (/^blob\\:/i.test(img.src)) { // Object URL\n                var fileReader = new FileReader();\n                fileReader.onload = function(e) {\n                    handleBinaryFile(e.target.result);\n                };\n                objectURLToBlob(img.src, function (blob) {\n                    fileReader.readAsArrayBuffer(blob);\n                });\n            } else {\n                var http = new XMLHttpRequest();\n                http.onload = function() {\n                    if (this.status == 200 || this.status === 0) {\n                        handleBinaryFile(http.response);\n                    } else {\n                        throw \"Could not load image\";\n                    }\n                    http = null;\n                };\n                http.open(\"GET\", img.src, true);\n                http.responseType = \"arraybuffer\";\n                http.send(null);\n            }\n        } else if (self.FileReader && (img instanceof self.Blob || img instanceof self.File)) {\n            var fileReader = new FileReader();\n            fileReader.onload = function(e) {\n                if (debug) console.log(\"Got file of length \" + e.target.result.byteLength);\n                handleBinaryFile(e.target.result);\n            };\n\n            fileReader.readAsArrayBuffer(img);\n        }\n    }\n\n    function findEXIFinJPEG(file) {\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n            if (debug) console.log(\"Not a valid JPEG\");\n            return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength,\n            marker;\n\n        while (offset < length) {\n            if (dataView.getUint8(offset) != 0xFF) {\n                if (debug) console.log(\"Not a valid marker at offset \" + offset + \", found: \" + dataView.getUint8(offset));\n                return false; // not a valid marker, something is wrong\n            }\n\n            marker = dataView.getUint8(offset + 1);\n            if (debug) console.log(marker);\n\n            // we could implement handling for other markers here,\n            // but we're only looking for 0xFFE1 for EXIF data\n\n            if (marker == 225) {\n                if (debug) console.log(\"Found 0xFFE1 marker\");\n\n                return readEXIFData(dataView, offset + 4, dataView.getUint16(offset + 2) - 2);\n\n                // offset += 2 + file.getShortAt(offset+2, true);\n\n            } else {\n                offset += 2 + dataView.getUint16(offset+2);\n            }\n\n        }\n\n    }\n\n    function findIPTCinJPEG(file) {\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n            if (debug) console.log(\"Not a valid JPEG\");\n            return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength;\n\n\n        var isFieldSegmentStart = function(dataView, offset){\n            return (\n                dataView.getUint8(offset) === 0x38 &&\n                dataView.getUint8(offset+1) === 0x42 &&\n                dataView.getUint8(offset+2) === 0x49 &&\n                dataView.getUint8(offset+3) === 0x4D &&\n                dataView.getUint8(offset+4) === 0x04 &&\n                dataView.getUint8(offset+5) === 0x04\n            );\n        };\n\n        while (offset < length) {\n\n            if ( isFieldSegmentStart(dataView, offset )){\n\n                // Get the length of the name header (which is padded to an even number of bytes)\n                var nameHeaderLength = dataView.getUint8(offset+7);\n                if(nameHeaderLength % 2 !== 0) nameHeaderLength += 1;\n                // Check for pre photoshop 6 format\n                if(nameHeaderLength === 0) {\n                    // Always 4\n                    nameHeaderLength = 4;\n                }\n\n                var startOffset = offset + 8 + nameHeaderLength;\n                var sectionLength = dataView.getUint16(offset + 6 + nameHeaderLength);\n\n                return readIPTCData(file, startOffset, sectionLength);\n\n                break;\n\n            }\n\n\n            // Not the marker, continue searching\n            offset++;\n\n        }\n\n    }\n    var IptcFieldMap = {\n        0x78 : 'caption',\n        0x6E : 'credit',\n        0x19 : 'keywords',\n        0x37 : 'dateCreated',\n        0x50 : 'byline',\n        0x55 : 'bylineTitle',\n        0x7A : 'captionWriter',\n        0x69 : 'headline',\n        0x74 : 'copyright',\n        0x0F : 'category'\n    };\n    function readIPTCData(file, startOffset, sectionLength){\n        var dataView = new DataView(file);\n        var data = {};\n        var fieldValue, fieldName, dataSize, segmentType, segmentSize;\n        var segmentStartPos = startOffset;\n        while(segmentStartPos < startOffset+sectionLength) {\n            if(dataView.getUint8(segmentStartPos) === 0x1C && dataView.getUint8(segmentStartPos+1) === 0x02){\n                segmentType = dataView.getUint8(segmentStartPos+2);\n                if(segmentType in IptcFieldMap) {\n                    dataSize = dataView.getInt16(segmentStartPos+3);\n                    segmentSize = dataSize + 5;\n                    fieldName = IptcFieldMap[segmentType];\n                    fieldValue = getStringFromDB(dataView, segmentStartPos+5, dataSize);\n                    // Check if we already stored a value with this name\n                    if(data.hasOwnProperty(fieldName)) {\n                        // Value already stored with this name, create multivalue field\n                        if(data[fieldName] instanceof Array) {\n                            data[fieldName].push(fieldValue);\n                        }\n                        else {\n                            data[fieldName] = [data[fieldName], fieldValue];\n                        }\n                    }\n                    else {\n                        data[fieldName] = fieldValue;\n                    }\n                }\n\n            }\n            segmentStartPos++;\n        }\n        return data;\n    }\n\n\n\n    function readTags(file, tiffStart, dirStart, strings, bigEnd) {\n        var entries = file.getUint16(dirStart, !bigEnd),\n            tags = {},\n            entryOffset, tag,\n            i;\n\n        for (i=0;i<entries;i++) {\n            entryOffset = dirStart + i*12 + 2;\n            tag = strings[file.getUint16(entryOffset, !bigEnd)];\n            if (!tag && debug) console.log(\"Unknown tag: \" + file.getUint16(entryOffset, !bigEnd));\n            tags[tag] = readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd);\n        }\n        return tags;\n    }\n\n\n    function readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd) {\n        var type = file.getUint16(entryOffset+2, !bigEnd),\n            numValues = file.getUint32(entryOffset+4, !bigEnd),\n            valueOffset = file.getUint32(entryOffset+8, !bigEnd) + tiffStart,\n            offset,\n            vals, val, n,\n            numerator, denominator;\n\n        switch (type) {\n            case 1: // byte, 8-bit unsigned int\n            case 7: // undefined, 8-bit byte, value depending on field\n                if (numValues == 1) {\n                    return file.getUint8(entryOffset + 8, !bigEnd);\n                } else {\n                    offset = numValues > 4 ? valueOffset : (entryOffset + 8);\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint8(offset + n);\n                    }\n                    return vals;\n                }\n\n            case 2: // ascii, 8-bit byte\n                offset = numValues > 4 ? valueOffset : (entryOffset + 8);\n                return getStringFromDB(file, offset, numValues-1);\n\n            case 3: // short, 16 bit int\n                if (numValues == 1) {\n                    return file.getUint16(entryOffset + 8, !bigEnd);\n                } else {\n                    offset = numValues > 2 ? valueOffset : (entryOffset + 8);\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint16(offset + 2*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 4: // long, 32 bit int\n                if (numValues == 1) {\n                    return file.getUint32(entryOffset + 8, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint32(valueOffset + 4*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 5:    // rational = two long values, first is numerator, second is denominator\n                if (numValues == 1) {\n                    numerator = file.getUint32(valueOffset, !bigEnd);\n                    denominator = file.getUint32(valueOffset+4, !bigEnd);\n                    val = new Number(numerator / denominator);\n                    val.numerator = numerator;\n                    val.denominator = denominator;\n                    return val;\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        numerator = file.getUint32(valueOffset + 8*n, !bigEnd);\n                        denominator = file.getUint32(valueOffset+4 + 8*n, !bigEnd);\n                        vals[n] = new Number(numerator / denominator);\n                        vals[n].numerator = numerator;\n                        vals[n].denominator = denominator;\n                    }\n                    return vals;\n                }\n\n            case 9: // slong, 32 bit signed int\n                if (numValues == 1) {\n                    return file.getInt32(entryOffset + 8, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getInt32(valueOffset + 4*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 10: // signed rational, two slongs, first is numerator, second is denominator\n                if (numValues == 1) {\n                    return file.getInt32(valueOffset, !bigEnd) / file.getInt32(valueOffset+4, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getInt32(valueOffset + 8*n, !bigEnd) / file.getInt32(valueOffset+4 + 8*n, !bigEnd);\n                    }\n                    return vals;\n                }\n        }\n    }\n\n    /**\n    * Given an IFD (Image File Directory) start offset\n    * returns an offset to next IFD or 0 if it's the last IFD.\n    */\n    function getNextIFDOffset(dataView, dirStart, bigEnd){\n        //the first 2bytes means the number of directory entries contains in this IFD\n        var entries = dataView.getUint16(dirStart, !bigEnd);\n\n        // After last directory entry, there is a 4bytes of data,\n        // it means an offset to next IFD.\n        // If its value is '0x00000000', it means this is the last IFD and there is no linked IFD.\n\n        return dataView.getUint32(dirStart + 2 + entries * 12, !bigEnd); // each entry is 12 bytes long\n    }\n\n    function readThumbnailImage(dataView, tiffStart, firstIFDOffset, bigEnd){\n        // get the IFD1 offset\n        var IFD1OffsetPointer = getNextIFDOffset(dataView, tiffStart+firstIFDOffset, bigEnd);\n\n        if (!IFD1OffsetPointer) {\n            // console.log('******** IFD1Offset is empty, image thumb not found ********');\n            return {};\n        }\n        else if (IFD1OffsetPointer > dataView.byteLength) { // this should not happen\n            // console.log('******** IFD1Offset is outside the bounds of the DataView ********');\n            return {};\n        }\n        // console.log('*******  thumbnail IFD offset (IFD1) is: %s', IFD1OffsetPointer);\n\n        var thumbTags = readTags(dataView, tiffStart, tiffStart + IFD1OffsetPointer, IFD1Tags, bigEnd)\n\n        // EXIF 2.3 specification for JPEG format thumbnail\n\n        // If the value of Compression(0x0103) Tag in IFD1 is '6', thumbnail image format is JPEG.\n        // Most of Exif image uses JPEG format for thumbnail. In that case, you can get offset of thumbnail\n        // by JpegIFOffset(0x0201) Tag in IFD1, size of thumbnail by JpegIFByteCount(0x0202) Tag.\n        // Data format is ordinary JPEG format, starts from 0xFFD8 and ends by 0xFFD9. It seems that\n        // JPEG format and 160x120pixels of size are recommended thumbnail format for Exif2.1 or later.\n\n        if (thumbTags['Compression']) {\n            // console.log('Thumbnail image found!');\n\n            switch (thumbTags['Compression']) {\n                case 6:\n                    // console.log('Thumbnail image format is JPEG');\n                    if (thumbTags.JpegIFOffset && thumbTags.JpegIFByteCount) {\n                    // extract the thumbnail\n                        var tOffset = tiffStart + thumbTags.JpegIFOffset;\n                        var tLength = thumbTags.JpegIFByteCount;\n                        thumbTags['blob'] = new Blob([new Uint8Array(dataView.buffer, tOffset, tLength)], {\n                            type: 'image/jpeg'\n                        });\n                    }\n                break;\n\n            case 1:\n                console.log(\"Thumbnail image format is TIFF, which is not implemented.\");\n                break;\n            default:\n                console.log(\"Unknown thumbnail image format '%s'\", thumbTags['Compression']);\n            }\n        }\n        else if (thumbTags['PhotometricInterpretation'] == 2) {\n            console.log(\"Thumbnail image format is RGB, which is not implemented.\");\n        }\n        return thumbTags;\n    }\n\n    function getStringFromDB(buffer, start, length) {\n        var outstr = \"\";\n        for (n = start; n < start+length; n++) {\n            outstr += String.fromCharCode(buffer.getUint8(n));\n        }\n        return outstr;\n    }\n\n    function readEXIFData(file, start) {\n        if (getStringFromDB(file, start, 4) != \"Exif\") {\n            if (debug) console.log(\"Not valid EXIF data! \" + getStringFromDB(file, start, 4));\n            return false;\n        }\n\n        var bigEnd,\n            tags, tag,\n            exifData, gpsData,\n            tiffOffset = start + 6;\n\n        // test for TIFF validity and endianness\n        if (file.getUint16(tiffOffset) == 0x4949) {\n            bigEnd = false;\n        } else if (file.getUint16(tiffOffset) == 0x4D4D) {\n            bigEnd = true;\n        } else {\n            if (debug) console.log(\"Not valid TIFF data! (no 0x4949 or 0x4D4D)\");\n            return false;\n        }\n\n        if (file.getUint16(tiffOffset+2, !bigEnd) != 0x002A) {\n            if (debug) console.log(\"Not valid TIFF data! (no 0x002A)\");\n            return false;\n        }\n\n        var firstIFDOffset = file.getUint32(tiffOffset+4, !bigEnd);\n\n        if (firstIFDOffset < 0x00000008) {\n            if (debug) console.log(\"Not valid TIFF data! (First offset less than 8)\", file.getUint32(tiffOffset+4, !bigEnd));\n            return false;\n        }\n\n        tags = readTags(file, tiffOffset, tiffOffset + firstIFDOffset, TiffTags, bigEnd);\n\n        if (tags.ExifIFDPointer) {\n            exifData = readTags(file, tiffOffset, tiffOffset + tags.ExifIFDPointer, ExifTags, bigEnd);\n            for (tag in exifData) {\n                switch (tag) {\n                    case \"LightSource\" :\n                    case \"Flash\" :\n                    case \"MeteringMode\" :\n                    case \"ExposureProgram\" :\n                    case \"SensingMethod\" :\n                    case \"SceneCaptureType\" :\n                    case \"SceneType\" :\n                    case \"CustomRendered\" :\n                    case \"WhiteBalance\" :\n                    case \"GainControl\" :\n                    case \"Contrast\" :\n                    case \"Saturation\" :\n                    case \"Sharpness\" :\n                    case \"SubjectDistanceRange\" :\n                    case \"FileSource\" :\n                        exifData[tag] = StringValues[tag][exifData[tag]];\n                        break;\n\n                    case \"ExifVersion\" :\n                    case \"FlashpixVersion\" :\n                        exifData[tag] = String.fromCharCode(exifData[tag][0], exifData[tag][1], exifData[tag][2], exifData[tag][3]);\n                        break;\n\n                    case \"ComponentsConfiguration\" :\n                        exifData[tag] =\n                            StringValues.Components[exifData[tag][0]] +\n                            StringValues.Components[exifData[tag][1]] +\n                            StringValues.Components[exifData[tag][2]] +\n                            StringValues.Components[exifData[tag][3]];\n                        break;\n                }\n                tags[tag] = exifData[tag];\n            }\n        }\n\n        if (tags.GPSInfoIFDPointer) {\n            gpsData = readTags(file, tiffOffset, tiffOffset + tags.GPSInfoIFDPointer, GPSTags, bigEnd);\n            for (tag in gpsData) {\n                switch (tag) {\n                    case \"GPSVersionID\" :\n                        gpsData[tag] = gpsData[tag][0] +\n                            \".\" + gpsData[tag][1] +\n                            \".\" + gpsData[tag][2] +\n                            \".\" + gpsData[tag][3];\n                        break;\n                }\n                tags[tag] = gpsData[tag];\n            }\n        }\n\n        // extract thumbnail\n        tags['thumbnail'] = readThumbnailImage(file, tiffOffset, firstIFDOffset, bigEnd);\n\n        return tags;\n    }\n\n   function findXMPinJPEG(file) {\n\n        if (!('DOMParser' in self)) {\n            // console.warn('XML parsing not supported without DOMParser');\n            return;\n        }\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n           if (debug) console.log(\"Not a valid JPEG\");\n           return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength,\n            dom = new DOMParser();\n\n        while (offset < (length-4)) {\n            if (getStringFromDB(dataView, offset, 4) == \"http\") {\n                var startOffset = offset - 1;\n                var sectionLength = dataView.getUint16(offset - 2) - 1;\n                var xmpString = getStringFromDB(dataView, startOffset, sectionLength)\n                var xmpEndIndex = xmpString.indexOf('xmpmeta>') + 8;\n                xmpString = xmpString.substring( xmpString.indexOf( '<x:xmpmeta' ), xmpEndIndex );\n\n                var indexOfXmp = xmpString.indexOf('x:xmpmeta') + 10\n                //Many custom written programs embed xmp/xml without any namespace. Following are some of them.\n                //Without these namespaces, XML is thought to be invalid by parsers\n                xmpString = xmpString.slice(0, indexOfXmp)\n                            + 'xmlns:Iptc4xmpCore=\"http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/\" '\n                            + 'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" '\n                            + 'xmlns:tiff=\"http://ns.adobe.com/tiff/1.0/\" '\n                            + 'xmlns:plus=\"http://schemas.android.com/apk/lib/com.google.android.gms.plus\" '\n                            + 'xmlns:ext=\"http://www.gettyimages.com/xsltExtension/1.0\" '\n                            + 'xmlns:exif=\"http://ns.adobe.com/exif/1.0/\" '\n                            + 'xmlns:stEvt=\"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#\" '\n                            + 'xmlns:stRef=\"http://ns.adobe.com/xap/1.0/sType/ResourceRef#\" '\n                            + 'xmlns:crs=\"http://ns.adobe.com/camera-raw-settings/1.0/\" '\n                            + 'xmlns:xapGImg=\"http://ns.adobe.com/xap/1.0/g/img/\" '\n                            + 'xmlns:Iptc4xmpExt=\"http://iptc.org/std/Iptc4xmpExt/2008-02-29/\" '\n                            + xmpString.slice(indexOfXmp)\n\n                var domDocument = dom.parseFromString( xmpString, 'text/xml' );\n                return xml2Object(domDocument);\n            } else{\n             offset++;\n            }\n        }\n    }\n\n    function xml2json(xml) {\n        var json = {};\n      \n        if (xml.nodeType == 1) { // element node\n          if (xml.attributes.length > 0) {\n            json['@attributes'] = {};\n            for (var j = 0; j < xml.attributes.length; j++) {\n              var attribute = xml.attributes.item(j);\n              json['@attributes'][attribute.nodeName] = attribute.nodeValue;\n            }\n          }\n        } else if (xml.nodeType == 3) { // text node\n          return xml.nodeValue;\n        }\n      \n        // deal with children\n        if (xml.hasChildNodes()) {\n          for(var i = 0; i < xml.childNodes.length; i++) {\n            var child = xml.childNodes.item(i);\n            var nodeName = child.nodeName;\n            if (json[nodeName] == null) {\n              json[nodeName] = xml2json(child);\n            } else {\n              if (json[nodeName].push == null) {\n                var old = json[nodeName];\n                json[nodeName] = [];\n                json[nodeName].push(old);\n              }\n              json[nodeName].push(xml2json(child));\n            }\n          }\n        }\n        \n        return json;\n    }\n\n    function xml2Object(xml) {\n        try {\n            var obj = {};\n            if (xml.children.length > 0) {\n              for (var i = 0; i < xml.children.length; i++) {\n                var item = xml.children.item(i);\n                var attributes = item.attributes;\n                for(var idx in attributes) {\n                    var itemAtt = attributes[idx];\n                    var dataKey = itemAtt.nodeName;\n                    var dataValue = itemAtt.nodeValue;\n\n                    if(dataKey !== undefined) {\n                        obj[dataKey] = dataValue;\n                    }\n                }\n                var nodeName = item.nodeName;\n\n                if (typeof (obj[nodeName]) == \"undefined\") {\n                  obj[nodeName] = xml2json(item);\n                } else {\n                  if (typeof (obj[nodeName].push) == \"undefined\") {\n                    var old = obj[nodeName];\n\n                    obj[nodeName] = [];\n                    obj[nodeName].push(old);\n                  }\n                  obj[nodeName].push(xml2json(item));\n                }\n              }\n            } else {\n              obj = xml.textContent;\n            }\n            return obj;\n          } catch (e) {\n              console.log(e.message);\n          }\n    }\n\n    EXIF.enableXmp = function() {\n        EXIF.isXmpEnabled = true;\n    }\n\n    EXIF.disableXmp = function() {\n        EXIF.isXmpEnabled = false;\n    }\n\n    EXIF.getData = function(img, callback) {\n        if (((self.Image && img instanceof self.Image)\n            || (self.HTMLImageElement && img instanceof self.HTMLImageElement))\n            && !img.complete)\n            return false;\n\n        if (!imageHasData(img)) {\n            getImageData(img, callback);\n        } else {\n            if (callback) {\n                callback.call(img);\n            }\n        }\n        return true;\n    }\n\n    EXIF.getTag = function(img, tag) {\n        if (!imageHasData(img)) return;\n        return img.exifdata[tag];\n    }\n    \n    EXIF.getIptcTag = function(img, tag) {\n        if (!imageHasData(img)) return;\n        return img.iptcdata[tag];\n    }\n\n    EXIF.getAllTags = function(img) {\n        if (!imageHasData(img)) return {};\n        var a,\n            data = img.exifdata,\n            tags = {};\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                tags[a] = data[a];\n            }\n        }\n        return tags;\n    }\n    \n    EXIF.getAllIptcTags = function(img) {\n        if (!imageHasData(img)) return {};\n        var a,\n            data = img.iptcdata,\n            tags = {};\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                tags[a] = data[a];\n            }\n        }\n        return tags;\n    }\n\n    EXIF.pretty = function(img) {\n        if (!imageHasData(img)) return \"\";\n        var a,\n            data = img.exifdata,\n            strPretty = \"\";\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                if (typeof data[a] == \"object\") {\n                    if (data[a] instanceof Number) {\n                        strPretty += a + \" : \" + data[a] + \" [\" + data[a].numerator + \"/\" + data[a].denominator + \"]\\r\\n\";\n                    } else {\n                        strPretty += a + \" : [\" + data[a].length + \" values]\\r\\n\";\n                    }\n                } else {\n                    strPretty += a + \" : \" + data[a] + \"\\r\\n\";\n                }\n            }\n        }\n        return strPretty;\n    }\n\n    EXIF.readFromBinaryFile = function(file) {\n        return findEXIFinJPEG(file);\n    }\n\n    if (typeof define === 'function' && define.amd) {\n        define('exif-js', [], function() {\n            return EXIF;\n        });\n    }\n}.call(this));\n\n","/* eslint-disable indent */\r\n/**\r\n * 压缩图片\r\n */\r\nimport EXIF from 'exif-js'\r\n// const EXIF = require('exif-js')\r\n\r\nfunction Compress() {}\r\n\r\n/**\r\n * 校验图片\r\n * @param { 图片文件 } file\r\n */\r\nCompress.prototype.validate = function (file) {\r\n  const imgReg = /image\\/jpeg|image\\/jpg|image\\/png/\r\n  if (!file) {\r\n    throw new Error('请传入图片!')\r\n  }\r\n  if (!imgReg.test(file.type)) {\r\n    throw new Error('非图片类型!,支持 jpeg, jpg, png')\r\n  }\r\n}\r\n\r\n/**\r\n * 图片压缩\r\n * @param { 图片文件 } file\r\n */\r\nCompress.prototype.core = function (file) {\r\n  const _this = this\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      _this.validate(file)\r\n      let result = {}\r\n      result.originalSize = getfilesize(file.size) // 原图大小\r\n      let orientation = ''\r\n      EXIF.getData(file, function () {\r\n        EXIF.getAllTags(this)\r\n        orientation = EXIF.getTag(this, 'Orientation')\r\n      })\r\n      let fileReader = new FileReader()\r\n      fileReader.onload = function (e) {\r\n        let image = new Image()\r\n        image.src = e.target.result\r\n        image.onload = function () {\r\n          let expectWidth = this.naturalWidth\r\n          let expectHeight = this.naturalHeight\r\n          result.originalGeometry = { width: expectWidth, height: expectHeight } // 原图几何大小\r\n          if (this.naturalWidth > this.naturalHeight && this.naturalWidth > 800) {\r\n            expectWidth = 800\r\n            expectHeight = (expectWidth * this.naturalHeight) / this.naturalWidth\r\n          } else if (this.naturalHeight > this.naturalWidth && this.naturalHeight > 1200) {\r\n            expectHeight = 1200\r\n            expectWidth = (expectHeight * this.naturalWidth) / this.naturalHeight\r\n          }\r\n          result.compressedGeometry = { width: expectWidth, height: expectHeight } // 压缩图几何大小\r\n          let canvas = document.createElement('canvas')\r\n          let ctx = canvas.getContext('2d')\r\n          canvas.width = expectWidth\r\n          canvas.height = expectHeight\r\n          ctx.drawImage(this, 0, 0, expectWidth, expectHeight)\r\n          _this.getBase64(orientation, canvas).then(base64 => {\r\n            result.compressedSize = getfilesize(base64.length) // 压缩后大小\r\n            result.base64 = base64\r\n            result.file = base64ConverFile(base64, file.name)\r\n            result.originFile = file\r\n            resolve(result)\r\n          })\r\n        }\r\n      }\r\n      fileReader.readAsDataURL(file)\r\n    } catch (error) {\r\n      reject(error)\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 获取图片getBase64\r\n */\r\nCompress.prototype.getBase64 = function (orientation, canvas) {\r\n  let base64 = null\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      detectImageAutomaticRotation().then(res => {\r\n        const isAutomaticRotation = res\r\n        // 如果是浏览器不会自动回正图片方向的iphone 则旋转方向\r\n        if (navigator.userAgent.match(/iphone/i && !isAutomaticRotation)) {\r\n          //如果方向角不为1，都需要进行旋转\r\n          if (orientation !== '' && orientation !== 1) {\r\n            switch (orientation) {\r\n              case 6: // 需要顺时针（向左）90度旋转\r\n                this.rotateImg(this, 'left', canvas)\r\n                break\r\n              case 8: // 需要逆时针（向右）90度旋转\r\n                this.rotateImg(this, 'right', canvas)\r\n                break\r\n              case 3: // 需要180度旋转\r\n                this.rotateImg(this, 'right', canvas) //转两次\r\n                this.rotateImg(this, 'right', canvas)\r\n                break\r\n            }\r\n          }\r\n          base64 = canvas.toDataURL('image/jpeg', 0.8)\r\n        } else {\r\n          base64 = canvas.toDataURL('image/jpeg', 0.8)\r\n        }\r\n        resolve(base64)\r\n      })\r\n    } catch (error) {\r\n      reject(error)\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 对图片旋转处理\r\n */\r\nCompress.prototype.rotateImg = function (img, direction, canvas) {\r\n  // 最小与最大旋转方向，图片旋转4次后回到原方向\r\n  let min_step = 0\r\n  let max_step = 3\r\n  if (img == null) return\r\n  // img的高度和宽度不能在img元素隐藏后获取，否则会出错\r\n  let height = img.height\r\n  let width = img.width\r\n  let step = 2\r\n  if (step == null) {\r\n    step = min_step\r\n  }\r\n  if (direction == 'right') {\r\n    step++\r\n    // 旋转到原位置，即超过最大值\r\n    step > max_step && (step = min_step)\r\n  } else {\r\n    step--\r\n    step < min_step && (step = max_step)\r\n  }\r\n  // 旋转角度以弧度值为参数\r\n  let degree = (step * 90 * Math.PI) / 180\r\n  let ctx = canvas.getContext('2d')\r\n  canvas.width = width\r\n  canvas.height = height\r\n  switch (step) {\r\n    case 0:\r\n      ctx.drawImage(img, 0, 0)\r\n      break\r\n    case 1:\r\n      ctx.rotate(degree)\r\n      ctx.drawImage(img, 0, -height)\r\n      break\r\n    case 2:\r\n      ctx.rotate(degree)\r\n      ctx.drawImage(img, -width, -height)\r\n      break\r\n    case 3:\r\n      ctx.rotate(degree)\r\n      ctx.drawImage(img, -width, 0)\r\n      break\r\n  }\r\n}\r\n\r\n/**\r\n * base64Url转file文件域\r\n * @param {String} base64Url 必须，图片base64字符串\r\n * @param {String} name 可选，图片名称，默认随机生成\r\n */\r\nfunction base64ConverFile(base64Url, filename) {\r\n  let arr = base64Url.split(','),\r\n    mime = arr[0].match(/:(.*?);/)[1],\r\n    bstr = atob(arr[1]),\r\n    n = bstr.length,\r\n    u8arr = new Uint8Array(n)\r\n  while (n--) {\r\n    u8arr[n] = bstr.charCodeAt(n)\r\n  }\r\n  return new File([u8arr], filename, { type: mime })\r\n}\r\n\r\n/**\r\n * 判断浏览器是否自动回正图片\r\n */\r\nfunction detectImageAutomaticRotation() {\r\n  const testAutoOrientationImageURL =\r\n    'data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAA' +\r\n    'AAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBA' +\r\n    'QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE' +\r\n    'BAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/x' +\r\n    'ABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAA' +\r\n    'AAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=='\r\n  let isImageAutomaticRotation\r\n  return new Promise(resolve => {\r\n    if (isImageAutomaticRotation === undefined) {\r\n      const img = new Image()\r\n      img.onload = () => {\r\n        // 如果图片变成 1x2，说明浏览器对图片进行了回正\r\n        isImageAutomaticRotation = img.width === 1 && img.height === 2\r\n        resolve(isImageAutomaticRotation)\r\n      }\r\n      img.src = testAutoOrientationImageURL\r\n    } else {\r\n      resolve(isImageAutomaticRotation)\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * 文件大小格式化\r\n * @param { 文件字节数 } size\r\n */\r\nfunction getfilesize(size) {\r\n  if (!size) return ''\r\n  const num = 1024.0 // byte\r\n  if (size < num) return size + 'B'\r\n  if (size < Math.pow(num, 2)) return (size / num).toFixed(2) + 'K' // kb\r\n  if (size < Math.pow(num, 3)) return (size / Math.pow(num, 2)).toFixed(2) + 'M' // M\r\n  if (size < Math.pow(num, 4)) return (size / Math.pow(num, 3)).toFixed(2) + 'G' // G\r\n  return (size / Math.pow(num, 4)).toFixed(2) + 'T' // T\r\n}\r\n\r\nexport default Compress\r\n"],"names":["debug","EXIF","obj","EXIFwrapped","module","exports","ExifTags","Tags","TiffTags","GPSTags","IFD1Tags","StringValues","ExposureProgram","MeteringMode","LightSource","Flash","SensingMethod","SceneCaptureType","SceneType","CustomRendered","WhiteBalance","GainControl","Contrast","Saturation","Sharpness","SubjectDistanceRange","FileSource","Components","imageHasData","img","exifdata","base64ToArrayBuffer","base64","contentType","match","replace","binary","atob","len","length","buffer","ArrayBuffer","view","Uint8Array","i","charCodeAt","objectURLToBlob","url","callback","http","XMLHttpRequest","open","responseType","onload","e","status","response","send","getImageData","handleBinaryFile","binFile","data","findEXIFinJPEG","iptcdata","findIPTCinJPEG","isXmpEnabled","xmpdata","findXMPinJPEG","call","src","test","arrayBuffer","fileReader","FileReader","target","result","blob","readAsArrayBuffer","self","Blob","File","file","dataView","DataView","getUint8","offset","byteLength","marker","readEXIFData","getUint16","isFieldSegmentStart","nameHeaderLength","startOffset","sectionLength","readIPTCData","IptcFieldMap","fieldValue","fieldName","dataSize","segmentType","segmentStartPos","getInt16","getStringFromDB","hasOwnProperty","Array","push","readTags","tiffStart","dirStart","strings","bigEnd","entries","tags","entryOffset","tag","console","log","readTagValue","type","numValues","getUint32","valueOffset","vals","val","n","numerator","denominator","Number","getInt32","getNextIFDOffset","readThumbnailImage","firstIFDOffset","IFD1OffsetPointer","thumbTags","JpegIFOffset","JpegIFByteCount","tOffset","tLength","start","outstr","String","fromCharCode","exifData","gpsData","tiffOffset","ExifIFDPointer","GPSInfoIFDPointer","dom","DOMParser","xmpString","xmpEndIndex","indexOf","substring","indexOfXmp","slice","domDocument","parseFromString","xml2Object","xml2json","xml","json","nodeType","attributes","j","attribute","item","nodeName","nodeValue","hasChildNodes","childNodes","child","old","children","idx","itemAtt","dataKey","dataValue","undefined","textContent","message","enableXmp","disableXmp","getData","Image","HTMLImageElement","complete","getTag","getIptcTag","getAllTags","a","getAllIptcTags","pretty","strPretty","readFromBinaryFile","this","Compress","prototype","validate","imgReg","Error","core","_this","Promise","resolve","reject","originalSize","getfilesize","size","orientation","image","expectWidth","naturalWidth","expectHeight","naturalHeight","originalGeometry","width","height","compressedGeometry","canvas","document","createElement","ctx","getContext","drawImage","getBase64","then","compressedSize","base64ConverFile","name","originFile","readAsDataURL","error","detectImageAutomaticRotation","res","isAutomaticRotation","navigator","userAgent","rotateImg","toDataURL","direction","min_step","max_step","step","degree","Math","PI","rotate","base64Url","filename","arr","split","mime","bstr","u8arr","testAutoOrientationImageURL","isImageAutomaticRotation","num","pow","toFixed"],"mappings":"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"}